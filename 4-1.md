# 薄膜光学参数的计算
## swanepoel方法拟合折射率与厚度
[10.1364/oe.25.000440] intro

准确测试薄膜材料的折射率、厚度等光学参数对于设计和制备高性能高质量的光学器件至关重要，至今已经发展了许多薄膜测试方法及仪器，包括椭偏法[4-6]、反射光谱法[9-11]和棱镜耦合法等方法。虽然这些方法能得到薄膜的折射率等光学参数，但存在许多不足之处，如:椭偏法建模复杂且测试时间很长，棱镜耦合法测试的折射率范围较窄等。对测试设备要求较低的是由swanepoel在1983年提出的透射谱方法，该方法仅需要薄膜的透射光谱即可得到薄膜的折射率和厚度等参数，不需要依赖于昂贵的测试仪器。因此，采用swanepoel方法测试折射率与厚度是目前常用的方法之一。此外，本文的带隙光光敏性测试方法基于原位的泵浦-探测法，因而swanepoel方法可以利用所有透射谱数据计算得到各个光学参数实时变化的特点契合了本文的测试原则，因此采用该方法。其他的薄膜测试方法均属于异位测试，只能得到初态与末态的信息，无法给出实时的变化。
swanepoel方法适用于单层膜结构，**如图所示**。
薄膜的透射谱可以表示为~
其中，~~。

在透明区，透射谱可以近似为
~~
其中，~~
在波长与厚度相差不大的情况下，在透射谱上可以观察到清晰的干涉条纹。由于衬底厚度远大于波长，因此仅考虑薄膜部分形成干涉条纹。厚度均匀的薄膜可等效于平板干涉，对于薄膜材料折射率大于衬底的情况，考虑半波损失，干涉条纹满足公式：~~  2pi/lambda*2nd+pi=m2pi 其中透射率极大时m为偶数，透射率极小时m为奇数。因此，TM,Tm可表示为：~~
将5式代入TM,Tm得到折射率 11~，其中~~

干涉条纹极大值TM与干涉条纹极小值Tm位于不同的波长处，对于求解折射率n的11式，TM,Tm应对应同一波长，因此需要根据透射谱拟合出上下两条包络线，上包络线对应干涉极大，下包络对应干涉极小，并且包络线与各个干涉峰相切，**如图所示**。
传统上采用多项式拟合透射谱包络，但对于干涉峰较少的情况（即薄膜厚度较小），多项式拟合容易造成过冲，不能很好的拟合平台区。swanepoel方法主要在透明区保持较高的精度，对于包络近似直线的平台区，拟合曲线的保形是非常重要的。因此，本文采用分段三次Hermite插值多项式（PCHIP）拟合透射谱包络，避免了拟合过冲造成的数据误差。在拟合完透射谱包络后，每个干涉峰对应一组TM与Tm，TM为上包络，Tm为下包络，将其代入11式得到相应波长的折射率。
由于该公式只能计算离散的折射率，为了得到连续的折射率，可对折射率数据点进行拟合。折射率拟合模型主要有Cauchy、Sellmeier、Herzberger等模型，在可见光波段的折射率拟合通常采用Cauchy模型:~~~。本文采用Cauchy模型对离散的折射率进行拟合。

由干涉条纹公式可以得到厚度d：
~~
其中n1,n2为两个分别位于lambda1、lambda2的一组相邻干涉极大峰或干涉极小峰的折射率。为了减小误差，将多组干涉峰计算的厚度取平均作为最终厚度值。

## 吸收系数与带隙的计算
由比尔定律得到吸收系数与透射率关系：
~~
薄膜透射谱在透明区与弱吸收区存在显著的干涉条纹，此时的透射率受到干涉的影响，不能直接用于计算吸收系数。而对于高吸收区域（无干涉峰），可直接将比尔定律计算得到的吸收系数作为实际值，其中厚度d为上文中swanepoel方法计算的结果。注意到此处忽略了空气与薄膜界面、薄膜与衬底界面和衬底与空气界面的菲涅耳反射，经验证，这种简化不影响数据的精确度。

非晶态硫系材料的吸收系数与光子能量满足Tauc定律：
~~
其中，Eg称为Tauc光学带隙，系数B称为Tauc斜率。对于直接带隙半导体，m=1/2，对于间接带隙半导体，m=3/2。
分别取~为横轴，~为纵轴作图，对高吸收区（α~10^4）进行线性拟合，得到的线性方程的斜率即为B1/2，与横轴的截距即为Eg。
